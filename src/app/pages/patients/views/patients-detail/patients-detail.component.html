<app-app-layout>
  <!-- <div class="flex justify-between">
    <h1 class="text-secondary-2 text-3xl">Detalle del paciente</h1>
    <div class="flex gap-x-6">
      <button (click)="handleClickEditPatientButton()"
        class="border-2 border-solid border-primary-3 size-10 fill-primary-3 rounded-md flex justify-center items-center hover:bg-primary-3 hover:fill-white transition">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="size-4/5">
          <path
            d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z" />
        </svg>
      </button>

      <button (click)="handleClickDeletePatientButton()"
        class="border-2 border-solid border-error size-10 fill-error rounded-md flex justify-center items-center hover:bg-error hover:fill-white transition">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="size-4/5">
          <path
            d="M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z" />
        </svg>
      </button>
    </div>
  </div>

  <div class="mt-2 flex gap-x-12">
    <div class="flex flex-col gap-y-1 outline outline-1 outline-gray-200 p-3 w-full">
      <label class="text-xs md:text-sm font-medium text-secondary-2">Nombre</label>
      <span class="bg-none outline-none text-lg md:text-xl xl:text-2xl placeholder:text-gray-300 text-secondary-1">
        {{patient.name}}
      </span>
    </div>

    <div class="flex flex-col gap-y-1 outline outline-1 outline-gray-200 p-3 w-full">
      <label class="text-xs md:text-sm font-medium text-secondary-2">Fecha de nacimiento</label>
      <span class="bg-none outline-none text-lg md:text-xl xl:text-2xl placeholder:text-gray-300 text-secondary-1">
        {{patient.birthdate | date: 'Y-MM-dd'}}
      </span>
    </div>

    <div class="flex flex-col gap-y-1 outline outline-1 outline-gray-200 p-3 w-full">
      <label class="text-xs md:text-sm font-medium text-secondary-2">Dirección</label>
      <span class="bg-none outline-none text-lg md:text-xl xl:text-2xl placeholder:text-gray-300 text-secondary-1">
        {{patient.direction}}
      </span>
    </div>

    <div class="flex flex-col gap-y-1 outline outline-1 outline-gray-200 p-3 w-full">
      <label class="text-xs md:text-sm font-medium text-secondary-2">Documento de identificacióñ</label>
      <span class="bg-none outline-none text-lg md:text-xl xl:text-2xl placeholder:text-gray-300 text-secondary-1">
        {{patient.document_identification}}
      </span>
    </div>
  </div>

  <div class="w-2/5 mt-10">
    <div class="flex justify-between mb-4">
      <h1 class="text-secondary-2 text-3xl">Condiciones del paciente</h1>

      <button (click)="handleClickAddConditionButton()"
        class="border-2 border-solid border-primary-3 size-10 fill-primary-3 rounded-md flex justify-center items-center hover:bg-primary-3 hover:fill-white transition">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="size-4/5">
          <path
            d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z" />
        </svg>
      </button>
    </div>

    @if (patient.conditions && patient.conditions.length > 0) {
    <table class="mt-2 w-full shadow-md rounded-sm overflow-hidden">
      <thead class="bg-secondary-1 text-2xl text-white">
        <tr>
          <th class="w-1/5 font-medium p-4">Descripcion</th>
          <th class="w-1/5 font-medium p-4">Opciones</th>
        </tr>
      </thead>
      <tbody>
        @for (condition of patient.conditions; track condition.id) {
        <tr class="hover:bg-gray-50">
          <td class="px-4 py-4 text-lg">{{condition.description}}</td>
          <td>
            <div class="flex justify-center gap-x-6">
              <button (click)="handleClickEditConditionButton($index)"
                class="border-2 border-solid border-primary-3 size-10 fill-primary-3 rounded-md flex justify-center items-center hover:bg-primary-3 hover:fill-white transition">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="size-4/5">
                  <path
                    d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z" />
                </svg>
              </button>
              <button (click)="handleClickDeleteConditionButton(condition.id)"
                class="border-2 border-solid border-error size-10 fill-error rounded-md flex justify-center items-center hover:bg-error hover:fill-white transition">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="size-4/5">
                  <path
                    d="M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z" />
                </svg>
              </button>
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
    }
    @else {
    <span class="text-gray-400">No hay condiciones registradas para este paciente</span>
    }
  </div> -->

  <div class="rounded-lg bg-white shadow-lg overflow-hidden mb-6">
    <!-- Patient Basic Info -->
    <div class="bg-primary-1 px-6 py-4 border-b border-secondary-1">
      <h3 class="text-lg font-medium text-secondary-2">Información básica</h3>
    </div>
    <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-4">
        <div>
          <p class="text-sm font-medium text-primary-3">Nombre completo</p>
          <p class="text-secondary-2">{{patient.name}}</p>
        </div>
        <div>
          <p class="text-sm font-medium text-primary-3">Fecha de nacimiento</p>
          <p class="text-secondary-2">{{patient.birthdate | date: 'Y-MM-dd'}} {{getAge(patient.birthdate)}}</p>
        </div>
      </div>
      <div class="space-y-4">
        <div>
          <p class="text-sm font-medium text-primary-3">Dirección</p>
          <p class="text-secondary-2">{{patient.direction}}</p>
        </div>
        <div>
          <p class="text-sm font-medium text-primary-3">Documento de identificación</p>
          <p class="text-secondary-2">{{patient.document_identification}}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Patient Conditions Card -->
  <div class="rounded-lg bg-white shadow-lg">
    <div class="bg-primary-1 px-6 py-4 border-b border-secondary-1">
      <h3 class="text-lg font-medium text-secondary-2">Condiciones del paciente</h3>
    </div>
    <div class="p-6">
      @if (patient.conditions && patient.conditions.length > 0) {
      <div >
        <table class="min-w-full divide-y divide-primary-1">
          <thead class="bg-primary-2">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-secondary-2 uppercase tracking-wider">
                Descripción
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-secondary-2 uppercase tracking-wider">
                Opciones
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-primary-1">
            @for (condition of patient.conditions; track condition.id) {
            <!-- Condition Row -->
            <tr>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-secondary-2">
                {{condition.description}}
              </td>
              <td class="relative px-6 py-4 whitespace-nowrap text-sm text-primary-3">
                <div class="absolute">
                  <app-row-options-menu (onSelect)="handleSelectOptionMenu(condition.id, $event)"/>
                </div>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
      }

      <!-- Add New Condition Button -->
      <div class="mt-4">
        <button class="rounded-lg bg-secondary-2 px-4 py-2 text-sm font-medium text-white hover:bg-secondary-1"
          (click)="handleClickAddConditionButton()">
          Añadir condición
        </button>
      </div>
    </div>
  </div>


</app-app-layout>
